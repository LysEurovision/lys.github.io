<style>
    body {
        font-family: 'Source Sans Pro', sans-serif;
    }

    .dark-mode {
        background: #121212;
        color: #fff;
    }

    .light-mode {
        background: #f0f0f0;
        color: #000;
    }

    .header {
        display: flex;
        align-items: center;
        width: 450px;
        margin: 0 auto;
        margin-top: 2em;
    }

    .header .logo {
        flex: 1;
        font-size: 48px;
    }

    .header .toggle {
        text-align: right;
        width: 30%;
    }

    .legend {
        width: 450px;
        margin: 0 auto;
        margin-top: 1em;
        font-size: 14px;
    }

    .legend .title {
        display: flex;
        align-items: center;
        font-size: 16px;
        font-style: italic;
    }

    #legend-toggle {
        text-decoration: none;
        margin-left: 0.25em;
    }

    .legend ul {
        padding: 0 2em;
    }

    .legend li {
        display: flex;
        align-items: center;
    }

    .legend li i {
        margin-right: 0.25em;
    }

    /* material switch - stolen from https://codepen.io/finnhvman/pen/pOeyjE */
    .pure-material-switch {
        z-index: 0;
        position: relative;
        display: inline-block;
        color: rgba(var(--pure-material-onsurface-rgb, 0, 0, 0), 0.87);
        font-family: var(--pure-material-font, "Roboto", "Segoe UI", BlinkMacSystemFont, system-ui, -apple-system);
        font-size: 16px;
        line-height: 1.5;
    }

    /* Input */
    .pure-material-switch > input {
        appearance: none;
        -moz-appearance: none;
        -webkit-appearance: none;
        z-index: -1;
        position: absolute;
        right: 6px;
        top: -8px;
        display: block;
        margin: 0;
        border-radius: 50%;
        width: 40px;
        height: 40px;
        background-color: rgba(var(--pure-material-onsurface-rgb, 0, 0, 0), 0.38);
        outline: none;
        opacity: 0;
        transform: scale(1);
        pointer-events: none;
        transition: opacity 0.3s 0.1s, transform 0.2s 0.1s;
    }

    /* Span */
    .pure-material-switch > span {
        display: inline-block;
        width: 100%;
        cursor: pointer;
    }

    /* Track */
    .pure-material-switch > span::before {
        content: "";
        float: right;
        display: inline-block;
        margin: 5px 0 5px 10px;
        border-radius: 7px;
        width: 36px;
        height: 14px;
        background-color: rgba(var(--pure-material-onsurface-rgb, 0, 0, 0), 0.38);
        vertical-align: top;
        transition: background-color 0.2s, opacity 0.2s;
    }

    /* Thumb */
    .pure-material-switch > span::after {
        content: "";
        position: absolute;
        top: 2px;
        right: 16px;
        border-radius: 50%;
        width: 20px;
        height: 20px;
        background-color: rgb(var(--pure-material-onprimary-rgb, 255, 255, 255));
        box-shadow: 0 3px 1px -2px rgba(0, 0, 0, 0.2), 0 2px 2px 0 rgba(0, 0, 0, 0.14), 0 1px 5px 0 rgba(0, 0, 0, 0.12);
        transition: background-color 0.2s, transform 0.2s;
    }

    /* Checked */
    .pure-material-switch > input:checked {
        right: -10px;
        background-color: rgb(var(--pure-material-primary-rgb, 33, 150, 243));
    }

    .pure-material-switch > input:checked + span::before {
        background-color: rgba(var(--pure-material-primary-rgb, 33, 150, 243), 0.6);
    }

    .pure-material-switch > input:checked + span::after {
        background-color: rgb(var(--pure-material-primary-rgb, 33, 150, 243));
        transform: translateX(16px);
    }

    /* Hover, Focus */
    .pure-material-switch:hover > input {
        opacity: 0.04;
    }

    .pure-material-switch > input:focus {
        opacity: 0.12;
    }

    .pure-material-switch:hover > input:focus {
        opacity: 0.16;
    }

    /* Active */
    .pure-material-switch > input:active {
        opacity: 1;
        transform: scale(0);
        transition: transform 0s, opacity 0s;
    }

    .pure-material-switch > input:active + span::before {
        background-color: rgba(var(--pure-material-primary-rgb, 33, 150, 243), 0.6);
    }

    .pure-material-switch > input:checked:active + span::before {
        background-color: rgba(var(--pure-material-onsurface-rgb, 0, 0, 0), 0.38);
    }

    /* Disabled */
    .pure-material-switch > input:disabled {
        opacity: 0;
    }

    .pure-material-switch > input:disabled + span {
        color: rgb(var(--pure-material-onsurface-rgb, 0, 0, 0));
        opacity: 0.38;
        cursor: default;
    }

    .pure-material-switch > input:disabled + span::before {
        background-color: rgba(var(--pure-material-onsurface-rgb, 0, 0, 0), 0.38);
    }

    .pure-material-switch > input:checked:disabled + span::before {
        background-color: rgba(var(--pure-material-primary-rgb, 33, 150, 243), 0.6);
    }

    .month-label {
        width: 450px;
        margin: 0 auto;
        font-size: 26px;
    }

    .month-label:not(:first-of-type) {
        margin-top: 0.5em;
    }

    .card {
        position: relative;
        margin: 0 auto;
        margin-top: 0.5em;
        width: 450px;
        border-radius: 8px;
        overflow: hidden;
        -webkit-box-shadow: 0 1px 3px rgba(0, 0, 0, 0.12), 0 1px 2px rgba(0, 0, 0, 0.24);
        -moz-box-shadow: 0 1px 3px rgba(0, 0, 0, 0.12), 0 1px 2px rgba(0, 0, 0, 0.24);
        -ms-box-shadow: 0 1px 3px rgba(0, 0, 0, 0.12), 0 1px 2px rgba(0, 0, 0, 0.24);
        -o-box-shadow: 0 1px 3px rgba(0, 0, 0, 0.12), 0 1px 2px rgba(0, 0, 0, 0.24);
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.12), 0 1px 2px rgba(0, 0, 0, 0.24);
    }

    .card .card-container {
        display: flex;
        align-items: stretch;
        width: 100%;
    }

    @media (max-width:600px)  {
        .card, .header, .legend, .month-label {
            width: 97%;
        }
    }

    .card .date {
        display: flex;
        align-items: center;
        width: 15%;
        border-right-style: solid;
    }

    .card .date .date-container {
        display: flex;
        flex-direction: column;
    }

    .card .date div {
        margin: 0 auto;
    }

    .card .date .day {
        font-size: 36px;
    }

    .card .date .month {
        font-size: 20px;
    }

    .card .date .time {
        font-size: 16px;
        margin-top: 0.5em;
    }

    .card .details, .card .actions {
        display: inline-block;
        font-size: 18px;
    }

    .card .details {
        /*width: 70%;*/
        flex:  1;
        padding: 16px;
    }

    .card .actions {
        width: 32%;
    }

    .actions a {
        text-decoration: none;
    }

    .vertical-container {
        width: auto;
    }

    .actions .vertical-container {
    }

    .card .details .country, .card .details .condensed-details {
        font-size: 18px;
    }

    .card .details .condensed-details {
        display: none;
    }

    .card .details .show-name {
        font-size: 22px;
        padding: 0.3em 0;
        line-height: 1em;
    }

    .card .details .show-stage {
        font-size: 16px;
    }

    .card .details .labels {
        margin-top:  0.3em;
    }

    .label, .link-label {
        font-size: 14px;
        display: inline-block;
        padding: 0.3em 0.5em;
        border-radius: 0.25em;
    }

    .watch-link-action {
        display: inline-block;
        width: 15%;
        padding: 16px 0;
        /*border-left: 1px solid #000;*/
        display: flex;
        align-items: center;
        text-decoration: none;
        color: #000;
    }

    .watch-link-action i {
        margin: 0 auto;
        font-size: 32px;
    }

    .watch-links-wrapper .watch-link {
        display: flex;
        text-decoration: none;
        padding: 0.5em;
        align-items: center;
    }

    .watch-links-wrapper .watch-link:first-of-type {
        padding: 1em 0.5em;
        font-weight: bold;
    }

    /*.watch-links-wrapper .watch-link:not(:first-of-type):not(:last-of-type) {
        border-bottom: 1px solid;
    }*/

    .watch-links-wrapper .watch-link:first-of-type .link {
        color: #000 !important;
    }

    .watch-links-wrapper .watch-link .link {
        font-size: 14px;
        font-style: italic;
        font-weight: initial;
    }

    .watch-links-wrapper .watch-link .link {
        margin-left: 0.5em;
        margin-right: 1em;
    }

    .actions .watch-link {
        font-size: 0;
        border-radius: 4.5px;
        background: #42A5F5;
        color: #000;
        -webkit-box-shadow: 0 1px 3px rgba(0, 0, 0, 0.12), 0 1px 2px rgba(0, 0, 0, 0.24);
        -moz-box-shadow: 0 1px 3px rgba(0, 0, 0, 0.12), 0 1px 2px rgba(0, 0, 0, 0.24);
        -ms-box-shadow: 0 1px 3px rgba(0, 0, 0, 0.12), 0 1px 2px rgba(0, 0, 0, 0.24);
        -o-box-shadow: 0 1px 3px rgba(0, 0, 0, 0.12), 0 1px 2px rgba(0, 0, 0, 0.24);
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.12), 0 1px 2px rgba(0, 0, 0, 0.24);
        font-weight: bold;
    }

    .watch-link div {
        display: inline-block;
        height: 100%;
        padding: 6px 0;
        font-size: 18px;
        margin: 0 auto;
        text-align: center;
    }

    /* DARK MODE */
    
    .dark-mode .header, .dark-mode .header .material-icons-outlined {
        color: #fff;
    }

    .dark-mode #legend-toggle {
        color: #fff;
    }

    .dark-mode .card {
        background: #1d1d1d;
    }

    .dark-mode .card .date {
        border-image: linear-gradient(to bottom, transparent 0, transparent 15%, #fff 15%, #fff 85%, transparent 85%, transparent 100% ) 10 / 0 2px 0 0;
    }

    .dark-mode .label {
        background: #2e2e2e;
        color: #fff;
    }

    .dark-mode .label.red {
        background: #cf6679;
        color: #000;
    }

    .dark-mode .watch-link-action {
        background: #2196EA;
    }

    .dark-mode .watch-links-wrapper .watch-link {
        color: #fff;
    }

    /*.dark-mode .watch-links-wrapper .watch-link:not(:first-of-type):not(:last-of-type) {
        border-color: #a0a0a0;
    }*/

    .dark-mode .watch-links-wrapper .watch-link .link {
        color: #808080;
    }

    .dark-mode .watch-links-wrapper .watch-link:first-of-type {
        background: #2196EA;
        color: #000 !important;
    }

    /* LIGHT MODE */
    
    .light-mode .header {
        color: #000;
    }

    .light-mode #legend-toggle {
        color: #000;
    }

    .light-mode .card {
        background: #ffffff;
    }

    .light-mode .card .date {
        border-image: linear-gradient(to bottom, transparent 0, transparent 15%, #000 15%, #000 85%, transparent 85%, transparent 100% ) 10 / 0 2px 0 0;
    }

    .light-mode .label {
        background: #e0e0e0;
    }

    .light-mode .label.red {
        background: #D81B60;
        color: #fff;
    }

    .light-mode .watch-link-action {
        background: #7EC5FF;
    }

    .light-mode .watch-links-wrapper .watch-link {
        color: #000;
    }

    .light-mode .watch-links-wrapper .watch-link:first-of-type {
        background: #7EC5FF;
    }
</style>
<script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
<script>
    function addMonthLabel(month) {
        $("#calendar").append(`<div class="month-label">${month}</div>`);
    }

    function addEvent(event, date) {
        const isChannelPresent = event['watchLinks'] && event['watchLinks'].length > 0 && 'channel' in event['watchLinks'][0] && event['watchLinks'][0]['channel'] != "";
        let htmlString = `
            <div class="card">
                <div class="card-container">
                    <div class="date">
                        <div class="date-container">
                            <div class="day">${date.toLocaleString('default', { day: '2-digit' })}</div>
                            <div class="month">${date.toLocaleString('default', { month: 'short' })}</div>
                            <div class="time">${date.toLocaleString('fr-FR', {hour: '2-digit', minute: '2-digit'})}</div>
                        </div>
                    </div>
                    <div class="details">
                        <div class="vertical-container">
                            <div class="condensable">
                                <div class="country">${event['country']}</div>
                                <div class="show-name">${event['name']}</div>
                                <div class="show-stage">${event['stage']}</div>
                                <div class="labels">
                                    ${isChannelPresent ? '<div class="label">' + event['watchLinks'][0]['channel'] + '</div>' : ''}
                                </div>
                            </div>
                        </div>
                    </div>
                    <a href="#!" class="watch-link-action">
                        <i class="material-icons">play_arrow</i>
                    </a>
                </div>
                <div class="watch-links-wrapper" style="display: none;">
        `
        event['watchLinks'].forEach((link) => {
            const comment = link['comment'] == "Recommended link" ? 'recommended' : link['comment'];
            const test = link['img'];
            htmlString += `
                <a href="${(!link['link'].startsWith('http') ? 'http://' : '') + link['link']}" class="watch-link">
                    <span class="title">Link #1 ${comment ? '(' + comment + ')' : ''}</span>
                    <span class="link">${link['link'].replace('https://', '').replace('http://', '').replace('www.', '').split('/', 2)[0]}</span>
                    ${link['geoblocked'] ? '<i class="material-icons">public_off</i>' : ''}
                    ${link['comment'] == 'Account required' ? '<i class="material-icons">user</i>' : ''}
                    ${link['castable'] ? '<i class="material-icons">cast</i>' : ''}
                    ${link['replayable'] ? '<i class="material-icons">replay</i>' : ''}
                </a>
            `;
        })
        htmlString += `
                </div>
            </div>
        `;
        $("#calendar").append(htmlString);
    }

    $(function() {
        $("#dark-mode-toggle").change(function() {
            if ($(this).is(":checked")) {
                $("body").removeClass("light-mode").addClass("dark-mode");
            } else {
                $("body").removeClass("dark-mode").addClass("light-mode");
            }
        });

        $("#legend-toggle").click(function() {
            const isLegendHidden = $(this).parent().siblings("ul").css("display") == "none";
            if (isLegendHidden) {
                $(this).parent().siblings("ul").css("display", "block");
                $(this).find(".material-icons").html("expand_less");
            } else {
                $(this).parent().siblings("ul").css("display", "none");
                $(this).find(".material-icons").html("expand_more");
            }
        });

        $.getJSON("https://raw.githubusercontent.com/LysEurovision/lys.github.io/main/lys_dump.json", function(data, status) {
            console.log(data);
            let lastMonth = "";
            data.forEach((event) => {
                const date = new Date(event['dateTimeCet'])
                const month = date.toLocaleString('default', { month: 'long' });
                if (month != lastMonth) {
                    lastMonth = month;
                    addMonthLabel(month);
                }
                addEvent(event, date);
            });

            $("a.watch-link-action").click(function() {
                const areLinksHidden = $(this).parent().siblings(".watch-links-wrapper").css("display") == "none";
                if (areLinksHidden) {
                    $(this).parent().siblings(".watch-links-wrapper").css("display", "block");
                    $(this).find(".material-icons").html("expand_less");
                } else {
                    $(this).parent().siblings(".watch-links-wrapper").css("display", "none");
                    $(this).find(".material-icons").html("play_arrow");
                }
            });
            // TODO
            // create cards & month labels
            // hide the (to be created) splash screen
            // hide older events behind a "show older" button
            // hide next events if loading takes too long? like 1) save fetched data 2) display 10 firsts 3) display 10 next fetched on button clicked
        })
    })
</script>
<meta content="width=device-width, initial-scale=1" name="viewport" />
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Source+Sans+Pro&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/icon?family=Material+Icons|Material+Icons+Outlined" rel="stylesheet">
<body class="dark-mode">
    <div class="header">
        <div class="logo">Lys</div>
        <div class="toggle">
            <label class="pure-material-switch">
                <input type="checkbox" id="dark-mode-toggle" checked>
                <span><i class="material-icons-outlined">dark_mode</i></span>
            </label>
        </div>
    </div>
    <div class="legend">
        <div class="title">Legend <a href="#!" id="legend-toggle"><i class="material-icons">expand_less</i></a></div>
        <ul>
            <li><i class="material-icons">public_off</i> Geoblocked</li>
            <li><i class="material-icons">person</i> Account required</li>
            <li><i class="material-icons">replay</i> Replayable</li>
            <li><i class="material-icons">cast</i> Castable</li>
        </ul>
    </div>
    <div id="calendar">
        <!-- <div class="month-label">January</div>
        <div class="card">
            <div class="card-container">
                <div class="date">
                    <div class="date-container">
                        <div class="day">15</div>
                        <div class="month">jan</div>
                        <div class="time">19.50</div>
                    </div>
                </div>
                <div class="details">
                    <div class="vertical-container">
                        <div class="condensable">
                            <div class="country">🇳🇴 Norway</div>
                            <div class="show-name">Melodi Grand Prix</div>
                            <div class="show-stage">Heat 1</div>
                            <div class="labels">
                                <div class="label">NRK1</div>
                                <div class="label">Account required</div>
                            </div>
                        </div>
                    </div>
                </div>
                <a href="#!" class="watch-link-action">
                    <i class="material-icons">play_arrow</i>
                </a>
            </div>
            <div class="watch-links-wrapper" style="display: none;">
                <a href="#!" class="watch-link">
                    <span class="title">Link #1 (recommended)</span>
                    <span class="link">nrk.no</span>
                </a>
                <a href="#!" class="watch-link">
                    <span>Link #2</span>
                    <span class="link">tv.nrk.no</span>
                    <i class="material-icons">cast</i>
                    <i class="material-icons">replay</i>
                </a>
                <a href="#!" class="watch-link">
                    <span>Link #3</span>
                    <span class="link">youtube.com</span>
                </a>
            </div>
        </div>

        <div class="card">
            <div class="card-container">
                <div class="date">
                    <div class="date-container">
                        <div class="day">30</div>
                        <div class="month">jan</div>
                        <div class="time">21.05</div>
                    </div>
                </div>
                <div class="details">
                    <div class="vertical-container">
                        <div class="condensable">
                            <div class="country">🇫🇷 France</div>
                            <div class="show-name">Eurovision France : c'est vous qui décidez !</div>
                            <div class="show-stage">Final</div>
                            <div class="labels">
                                <div class="label">France 2</div>
                            </div>
                        </div>
                    </div>
                </div>
                <a href="#!" class="watch-link-action">
                    <i class="material-icons">play_arrow</i>
                </a>
            </div>
            <div class="watch-links-wrapper" style="display: none;">
                <a href="#!" class="watch-link">
                    <span class="title">Link #1 (recommended)</span>
                    <span class="link">france.tv</span>
                    <i class="material-icons">cast</i>
                    <i class="material-icons">replay</i>
                </a>
            </div>
        </div>

        <div class="month-label">February</div>

        <div class="card">
            <div class="card-container">
                <div class="date">
                    <div class="date-container">
                        <div class="day">05</div>
                        <div class="month">feb</div>
                        <div class="time">20.00</div>
                    </div>
                </div>
                <div class="details">
                    <div class="vertical-container">
                        <div class="condensable">
                            <div class="country">🇸🇪 Sweden</div>
                            <div class="show-name">Melodifestivalen</div>
                            <div class="show-stage">Heat 1</div>
                            <div class="labels">
                                <div class="label">SVT1</div>
                            </div>
                        </div>
                    </div>
                </div>
                <a href="#!" class="watch-link-action">
                    <i class="material-icons">play_arrow</i>
                </a>
            </div>
            <div class="watch-links-wrapper" style="display: none;">
                <a href="#!" class="watch-link">
                    <span class="title">Link #1 (recommended)</span>
                    <span class="link">svt.se</span>
                </a>
            </div>
        </div>

        <div class="card">
            <div class="card-container">
                <div class="date">
                    <div class="date-container">
                        <div class="day">12</div>
                        <div class="month">feb</div>
                        <div class="time">20.00</div>
                    </div>
                </div>
                <div class="details">
                    <div class="vertical-container">
                        <div class="condensable">
                            <div class="country">🇸🇪 Sweden</div>
                            <div class="show-name">Melodifestivalen</div>
                            <div class="show-stage">Heat 2</div>
                            <div class="labels">
                                <div class="label">SVT1</div>
                            </div>
                        </div>
                    </div>
                </div>
                <a href="#!" class="watch-link-action">
                    <i class="material-icons">play_arrow</i>
                </a>
            </div>
            <div class="watch-links-wrapper" style="display: none;">
                <a href="#!" class="watch-link">
                    <span class="title">Link #1 (recommended)</span>
                    <span class="link">svt.se</span>
                </a>
            </div>
        </div> -->
    </div>
</body>